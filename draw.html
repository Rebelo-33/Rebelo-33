<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Draw Name</title>
  <link rel="stylesheet" href="style.css" />
  <script defer src="language.js"></script>
  <script defer type="module">
    import { loadListFromCode, drawName } from './scripts.js';

    let drawnResult = null;
    let userName = "";
    let listCode = new URLSearchParams(window.location.search).get("list");

    document.addEventListener("DOMContentLoaded", async () => {
      if (!listCode) {
        alert("No list code provided.");
        return;
      }

      const data = await loadListFromCode(listCode);
      if (!data) return;

      const listInfo = document.getElementById("listInfo");
      listInfo.innerHTML = `<p><strong data-lang="listNameLabel">List Name:</strong> ${data.name}</p>
        <p><strong data-lang="participantsLabel">Participants:</strong> ${data.participants.join(", ")}</p>`;

      document.getElementById("drawButton").onclick = async () => {
        userName = document.getElementById("userNameInput").value.trim();
        if (!userName) {
          alert("Please enter your name.");
          return;
        }
        drawnResult = await drawName(listCode, userName);
        document.getElementById("drawnName").textContent = `You got: ${drawnResult}`;
        document.getElementById("drawButton").style.display = 'none';
      };
    });
  </script>
</head>
<body>
  <div class="container">
    <h1>üéÅ <span data-lang="title">Secret Gift Exchange</span></h1>

    <!-- Language Selector -->
    <select id="language-selector">
      <option value="en">English</option>
      <option value="es">Espa√±ol</option>
      <option value="fr">Fran√ßais</option>
      <option value="pt">Portugu√™s</option>
    </select>

    <p data-lang="drawIntro">Click the button below to draw a name. You will only be able to draw once.</p>

    <!-- User Input -->
    <input type="text" id="userNameInput" placeholder="Enter your name" />
    <button id="drawButton" data-lang="drawName">Draw Name</button>
    <p id="drawnName"></p>

    <!-- List Info -->
    <div id="listInfo"></div>

    <!-- Back Home -->
    <button onclick="window.location.href='index.html'" data-lang="backHome">Back to Home</button>
  </div>
</body>
</html>
